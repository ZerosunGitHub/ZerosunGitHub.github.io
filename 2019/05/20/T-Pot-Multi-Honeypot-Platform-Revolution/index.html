<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">



  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="SS-aLvwhoJVDgx--OYNTkN2r0eHa3a2gMddNdAaKEBQ" />




















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png?v=6.4.0">


  <link rel="mask-icon" href="/images/favicon.png?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.4.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":true},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="T-Pot:多蜜罐平台革命T-Pot 19.03 T-Pot 19.03 runs on Debian (Sid), is based heavily on docker, docker-compose and includes dockerized versions of the following honeypots adbhoney, ciscoasa, conpot, cowrie, di">
<meta name="keywords" content="Honeypot">
<meta property="og:type" content="article">
<meta property="og:title" content="T-Pot:Multi-Honeypot-Platform-Revolution">
<meta property="og:url" content="https://zerosun.top/2019/05/20/T-Pot-Multi-Honeypot-Platform-Revolution/index.html">
<meta property="og:site_name" content="北岸冷若冰霜">
<meta property="og:description" content="T-Pot:多蜜罐平台革命T-Pot 19.03 T-Pot 19.03 runs on Debian (Sid), is based heavily on docker, docker-compose and includes dockerized versions of the following honeypots adbhoney, ciscoasa, conpot, cowrie, di">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://github.com/dtag-dev-sec/dtag-dev-sec.github.io/blob/master/assets/images/architecture.png?raw=true">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/kibana.png">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/cockpit1.png">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/cockpit2.png">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/cockpit3.png">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/cyberchef.png">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/spiderfoot.png">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/spiderfoot.png">
<meta property="og:image" content="https://dtag-dev-sec.github.io/assets/images/kibana.png">
<meta property="og:updated_time" content="2019-06-02T11:40:07.194Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="T-Pot:Multi-Honeypot-Platform-Revolution">
<meta name="twitter:description" content="T-Pot:多蜜罐平台革命T-Pot 19.03 T-Pot 19.03 runs on Debian (Sid), is based heavily on docker, docker-compose and includes dockerized versions of the following honeypots adbhoney, ciscoasa, conpot, cowrie, di">
<meta name="twitter:image" content="https://github.com/dtag-dev-sec/dtag-dev-sec.github.io/blob/master/assets/images/architecture.png?raw=true">



  <link rel="alternate" href="/atom.xml" title="北岸冷若冰霜" type="application/atom+xml" />




  <link rel="canonical" href="https://zerosun.top/2019/05/20/T-Pot-Multi-Honeypot-Platform-Revolution/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>T-Pot:Multi-Honeypot-Platform-Revolution | 北岸冷若冰霜</title>
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-125030623-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125030623-1');
</script>






  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>


<!-- 小屏幕不显示fork me on github   -->
  <style>
  .forkme{
    display: none;
  }
  @media (min-width: 768px) {
    .forkme{
      display: inline;
    }
  }
  </style>
<!-- 小屏幕不显示fork me on github -->


</head>

<!-- 设置首页或者（文章页没有动态效果时候）页动态背景 -->
<!-- <script type="text/javascript" color="120,165,241" count="10" src="canvas-nest.min.js"> </script> -->
<!-- 设置动态背景 -->


<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<!-- 设置左上角fork me on github效果     -->
    <!-- <a href="https://github.com/ZerosunGitHub">
      <img style="position: absolute; top: 0; left: 0; border: 0;" 
            src="https://s3.amazonaws.com/github/ribbons/forkme_left_white_ffffff.png"
            alt="Fork me on GitHub">
    </a> -->
<!-- 设置左上角fork me on github效果     -->

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">北岸冷若冰霜</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">觉得自己过得不好，一定是太长时间没有读书了</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档<span class="badge">22</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类<span class="badge">6</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签<span class="badge">27</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-link">
    <a href="/link/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-link"></i> <br />链接</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zerosun.top/2019/05/20/T-Pot-Multi-Honeypot-Platform-Revolution/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="北岸冷若冰霜">
      <meta itemprop="description" content="和孤独签订体面的协议">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="北岸冷若冰霜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">T-Pot:Multi-Honeypot-Platform-Revolution
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-20 17:05:26" itemprop="dateCreated datePublished" datetime="2019-05-20T17:05:26+08:00">2019-05-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-06-02 19:40:07" itemprop="dateModified" datetime="2019-06-02T19:40:07+08:00">2019-06-02</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/tools/" itemprop="url" rel="index"><span itemprop="name">tools</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon"
            >
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="T-Pot-多蜜罐平台革命"><a href="#T-Pot-多蜜罐平台革命" class="headerlink" title="T-Pot:多蜜罐平台革命"></a>T-Pot:多蜜罐平台革命</h1><p>T-Pot 19.03 T-Pot 19.03 runs on Debian (Sid), is based heavily on docker, docker-compose and includes dockerized versions of the following honeypots adbhoney, ciscoasa, conpot, cowrie, dionaea, elasticpot, glastopf, glutton, heralding, honeypy, honeytrap, mailoney, medpot, rdpy, snare, tanner Furthermore we use the following tools Cockpit for a lightweight, webui for…<br><a id="more"></a></p>
<h2 id="0x00简述篇"><a href="#0x00简述篇" class="headerlink" title="0x00简述篇"></a>0x00简述篇</h2><h3 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h3><p>DTAG 社区蜜罐项目：<a href="http://dtag-dev-sec.github.io/" target="_blank" rel="noopener">http://dtag-dev-sec.github.io/</a><br>官方简介 Release T-Pot 19.03：<a href="https://dtag-dev-sec.github.io/mediator/feature/2019/04/01/tpot-1903.html" target="_blank" rel="noopener">https://dtag-dev-sec.github.io/mediator/feature/2019/04/01/tpot-1903.html</a><br>项目地址：<a href="https://github.com/dtag-dev-sec/tpotce" target="_blank" rel="noopener">https://github.com/dtag-dev-sec/tpotce</a>  </p>
<h3 id="系统架构"><a href="#系统架构" class="headerlink" title="系统架构"></a>系统架构</h3><p>T-pot MuMulti-Honeypot-Platform-Revolution 的系统架构图<br><img src="https://github.com/dtag-dev-sec/dtag-dev-sec.github.io/blob/master/assets/images/architecture.png?raw=true" alt="img"></p>
<h3 id="态势概览"><a href="#态势概览" class="headerlink" title="态势概览"></a>态势概览</h3><p>实时统计各项攻击行为，清晰的各种报表统计，准确定位攻击源IP与真实地理位置.<br><img src="https://dtag-dev-sec.github.io/assets/images/kibana.png" alt="img">  </p>
<h3 id="技术概念"><a href="#技术概念" class="headerlink" title="技术概念"></a>技术概念</h3><p>T-Pot基于linux的网络安装程序。蜜罐守护程序以及正在使用的其他支持组件已使用Docker进行集装箱化。这允许我们在同一网络接口上运行多个蜜罐守护进程，同时保持较小的占用空间并限制每个蜜罐在其自己的环境中。</p>
<h4 id="Dockerized-Honeypots"><a href="#Dockerized-Honeypots" class="headerlink" title="Dockerized Honeypots"></a>Dockerized Honeypots</h4><p>在T-pot中含有以下各种dockerized honeypots</p>
<ul>
<li><a href="https://github.com/huuck/ADBHoney" target="_blank" rel="noopener">adbhoney</a><br>低交互工控蜜罐，提供一系列通用工业控制协议, 能够模拟复杂的工控基础设施。</li>
<li><a href="https://github.com/Cymmetria/ciscoasa_honeypot" target="_blank" rel="noopener">ciscoasa</a><br>基于kippo更改的中交互ssh蜜罐, 可以对暴力攻击账号密码等记录，并提供伪造的文件系统环境记录黑客操作行为, 并保存通过wget/curl下载的文件以及通过SFTP、SCP上传的文件。</li>
<li><a href="http://conpot.org/" target="_blank" rel="noopener">conpot</a><br>低交互工控蜜罐，提供一系列通用工业控制协议, 能够模拟复杂的工控基础设施。</li>
<li><a href="http://www.micheloosterhof.com/cowrie/" target="_blank" rel="noopener">cowrie</a><br>基于kippo更改的中交互ssh蜜罐, 可以对暴力攻击账号密码等记录，并提供伪造的文件系统环境记录黑客操作行为, 并保存通过wget/curl下载的文件以及通过SFTP、SCP上传的文件。</li>
<li><a href="https://github.com/DinoTools/dionaea" target="_blank" rel="noopener">dionaea</a><br>Dionaea是运行于Linux上的一个应用程序，将程序运行于网络环境下，它开放Internet常见服务的默认端口，当有外来连接时，模拟正常服务给予反馈，同时记录下出入网络数据流。网络数据流经由检测模块检测后按类别进行处理，如果有 shellcode 则进行仿真执行；程序会自动下载 shellcode 中指定或后续攻击命令指定下载的恶意文件。</li>
<li><a href="https://github.com/schmalle/ElasticPot" target="_blank" rel="noopener">elasticpot</a><br>模拟elastcisearch RCE漏洞的蜜罐，通过伪造函数在/,/_search, /_nodes的请求上回应脆弱ES实例的JSON格式消息。</li>
<li><a href="http://mushmush.org/" target="_blank" rel="noopener">glastopf</a><br>低交互型Web应用蜜罐, Glastopf蜜罐它能够模拟成千上万的web漏洞，针对攻击的不同攻击手段来回应攻击者，然后从对目标Web应用程序的攻击过程中收集数据。它的目标是针对自动化漏洞扫描/利用工具，通过对漏洞利用方式进行归类，针对某一类的利用方式返回对应的合理结果，以此实现低交互。</li>
<li><a href="https://github.com/mushorg/glutton" target="_blank" rel="noopener">glutton</a><br>所有吃蜜罐,可喂食蜜罐。</li>
<li><a href="https://github.com/johnnykv/heralding" target="_blank" rel="noopener">heralding</a><br>一个捕获蜜罐的凭证。</li>
<li><a href="https://github.com/foospidy/HoneyPy" target="_blank" rel="noopener">honeypy</a><br>一种低交互蜜罐能力，具有更强的媒体交互能力。 HoneyPy是用 python 编写的，目的是便于使用： 部署，使用插件扩展功能，并应用自定义配置。 交互的级别由插件的功能决定。 可以创建插件来模拟基于UDP或者基于TCP的服务，从而提供更多交互。 默认情况下，所有活动都记录到文件中，但将蜜罐活动发布到 Twitter 或者web服务端点也可以.</li>
<li><a href="https://github.com/armedpot/honeytrap/" target="_blank" rel="noopener">honeytrap</a><br>观察针对TCP或UDP服务的攻击，作为一个守护程序模拟一些知名的服务，并能够分析攻击字符串，执行相应的下载文件指令。</li>
<li><a href="https://github.com/awhitehatter/mailoney" target="_blank" rel="noopener">mailoney</a><br>SMTP蜜罐，开放继电器，通过 python 编写的信誉收集器。</li>
<li><p><a href="https://github.com/schmalle/medpot" target="_blank" rel="noopener">medpot</a>  </p>
</li>
<li><p><a href="https://github.com/citronneur/rdpy" target="_blank" rel="noopener">rdpy</a><br>Rdpy 是一个用 Python 实现的 RDP 和 VNC 协议，可以用作服务端以及客户端，同时也提供 RDP 的蜜罐，用于记录 RDP 的过程</p>
</li>
<li><a href="http://mushmush.org/" target="_blank" rel="noopener">snare</a><br>Snare/Tanner是web蜜罐Glastopf 的继任者。SNARE是一个Web应用程序蜜罐传感器，可以吸引来自Internet的各种恶意。</li>
<li><a href="http://mushmush.org/" target="_blank" rel="noopener">tanner</a><br>Snare/Tanner是web蜜罐Glastopf 的继任者。TANNER是一种远程数据分析和分类服务，用于评估HTTP请求并组成SNARE事件服务的响应。</li>
</ul>
<h4 id="Further-Tools"><a href="#Further-Tools" class="headerlink" title="Further Tools"></a>Further Tools</h4><p>在主机上同时安装了以下几种工具</p>
<ul>
<li><a href="https://cockpit-project.org/running" target="_blank" rel="noopener">Cockpit</a><br>for a lightweight, webui for docker, os, real-time performance monitoring and web terminal.Cockpit 使得 Linux 系统管理员、系统维护员和开发者能轻松地管理他们的服务器并执行一些简单的任务，例如管理存储、检测日志、启动或停止服务以及一些其它任务。它的报告界面添加了一些很好的功能使得可以轻松地在终端和 Web 界面之间切换。另外，它不仅使得管理一台服务器变得简单，更重要的是只需要一个单击就可以在一个地方同时管理多个通过网络连接的服务器.</li>
<li><a href="https://gchq.github.io/CyberChef/" target="_blank" rel="noopener">Cyberchef</a><br>a web app for encryption, encoding, compression and data analysis.英国情报机构-英国情报机构政府通信总部（GCHQ）发布了一款新型的开源Web工具，这款工具可以帮助安全研究人员更好地分析和解密数据。这款工具名为CyberChef，而它也被GCHQ誉为网络版的“瑞士军刀”。CyberChef是一款非常简单且直观的Web应用，使用者可以在一个Web浏览器中完成各种各样的网络操作。这些操作包括创建hexdump，进行XOR或Base64等简单的编码，进行类似AES、DES和Blowfish等复杂的加密处理，数据压缩或解压缩，计算哈希和校验值，以及对IPv6和X.509数据进行解析等等。”</li>
<li><a href="https://www.elastic.co/videos" target="_blank" rel="noopener">ELK stack</a><br>to beautifully visualize all the events captured by T-Pot.优雅地可视化T-Pot捕获到的攻击事件</li>
<li><a href="https://mobz.github.io/elasticsearch-head/" target="_blank" rel="noopener">Elasticsearch Head</a><br>a web front end for browsing and interacting with an Elastic Search cluster.一个web前端来浏览和操作ElasticSearch集群.</li>
<li><a href="https://github.com/smicallef/spiderfoot" target="_blank" rel="noopener">Spiderfoot</a><br>a open source intelligence automation tool.SpiderFoot是一个Python编写的免费开源的网站信息收集类工具，并且支持跨平台运行，适用于Linux、*BSD和Windows系统。此外，它还为用户提供了一个易于使用的GUI界面。在功能方面SpiderFoot也为我们考虑的非常周全，通过SpiderFoot我们可以获取相关目标的各种信息，例如网站子域、电子邮件地址、web服务器版本等等。SpiderFoot简单的基于Web的界面，使你能够在安装后立即启动扫描 – 只需简单的设置扫描目标域名，并启用相应的扫描模块即可。</li>
<li><a href="http://suricata-ids.org/" target="_blank" rel="noopener">Suricata</a><br>a Network Security Monitoring engine.开源的网络安全威胁检测引擎。</li>
</ul>
<h2 id="0x01安装篇"><a href="#0x01安装篇" class="headerlink" title="0x01安装篇"></a>0x01安装篇</h2><ul>
<li><p>1.环境准备</p>
<ul>
<li>先安装主机系统，官方指定Debian系统，建议9.7及更新版本，测试过程使用的是：debian-9.9.0-amd64-xfce ，下载地址：<a href="https://mirrors.tuna.tsinghua.edu.cn/debian-cd/current/amd64/iso-cd/debian-9.9.0-amd64-xfce-CD-1.iso" target="_blank" rel="noopener">9.9.0 (amd64, CD installer with xfce)</a> </li>
<li>6-8 GB RAM (less RAM is possible but might introduce swapping)</li>
<li>128 GB SSD (smaller is possible but limits the capacity of storing events)</li>
<li>Network via DHCP</li>
<li>A working, non-proxied, internet connection</li>
</ul>
</li>
<li><p>2.项目下载  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/dtag-dev-sec/tpotce</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.脚本安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd tpotce/iso/installer/</span><br><span class="line">su root</span><br></pre></td></tr></table></figure>
<ul>
<li><p>2.1 方法一：手动配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./install.sh --type=user</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.2 方法二：自动配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp tpot.conf.dist tpot.conf</span><br><span class="line">./install.sh --type=auto --conf=tpot.conf	</span><br><span class="line">	# 配置文件里面含有64297端口进行Web管理的用户名和密码</span><br><span class="line">	# 即用户名webuser，密码w3b$ecret</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>因需下载文件多来自国外的源，安装过程需要很久的等待,安装完成过后，系统将自动重启。  </p>
<p>3.首次运行</p>
<ul>
<li><p>SSH and Web Access<br>Browser and access the Admin UI: <code>https://&lt;your.ip&gt;:64294</code><br>SSH to access the command line: <code>ssh -l username -p 64295 &lt;your.ip&gt;</code>  </p>
<blockquote>
<p>user: <strong>[tsec or user]</strong> <em>you chose during one of the post Debian install methods</em><br>pass: <strong>[password]</strong> <em>you chose during the Debian installation</em></p>
</blockquote>
</li>
<li><p>Kibana Dashboard<br>Browser and access the Web UI: <code>https://&lt;your.ip&gt;:64297</code>  </p>
<blockquote>
<p>user: <strong>[user]</strong> <em>you chose during the installation，according to tpot.conf</em><br>pass: <strong>[password]</strong> <em>you chose during the installation，according to tpot.conf</em></p>
</blockquote>
</li>
</ul>
<h2 id="0x02使用篇"><a href="#0x02使用篇" class="headerlink" title="0x02使用篇"></a>0x02使用篇</h2><h3 id="服务器管理：Web-Access"><a href="#服务器管理：Web-Access" class="headerlink" title="服务器管理：Web Access"></a>服务器管理：Web Access</h3><h4 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h4><p>Cockpit Overview<br><img src="https://dtag-dev-sec.github.io/assets/images/cockpit1.png" alt="img">  </p>
<h4 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h4><p>Cockpit Containers<br><img src="https://dtag-dev-sec.github.io/assets/images/cockpit2.png" alt="img"><br>需要将登录用户添加到docker用户组中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 将当前用户加入docker组：</span><br><span class="line">$ sudo usermod -aG docker $USER</span><br></pre></td></tr></table></figure></p>
<h4 id="终端"><a href="#终端" class="headerlink" title="终端"></a>终端</h4><p>Cockpit Terminal<br><img src="https://dtag-dev-sec.github.io/assets/images/cockpit3.png" alt="img">  </p>
<h3 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h3><h4 id="Cyberchef"><a href="#Cyberchef" class="headerlink" title="Cyberchef"></a>Cyberchef</h4><p><img src="https://dtag-dev-sec.github.io/assets/images/cyberchef.png" alt="img">  </p>
<h4 id="ES-Head-Plugin"><a href="#ES-Head-Plugin" class="headerlink" title="ES Head Plugin"></a>ES Head Plugin</h4><p><img src="https://dtag-dev-sec.github.io/assets/images/spiderfoot.png" alt="img">  </p>
<h4 id="Spiderfoot"><a href="#Spiderfoot" class="headerlink" title="Spiderfoot"></a>Spiderfoot</h4><p><img src="https://dtag-dev-sec.github.io/assets/images/spiderfoot.png" alt="img">  </p>
<h3 id="蜜罐可视化：Kibana-Dashboard"><a href="#蜜罐可视化：Kibana-Dashboard" class="headerlink" title="蜜罐可视化：Kibana Dashboard"></a>蜜罐可视化：Kibana Dashboard</h3><p>涉及较多的Kibana可视化配置，<br><img src="https://dtag-dev-sec.github.io/assets/images/kibana.png" alt="img">  </p>
<h2 id="0x03优化篇"><a href="#0x03优化篇" class="headerlink" title="0x03优化篇"></a>0x03优化篇</h2><h3 id="Updates"><a href="#Updates" class="headerlink" title="Updates"></a>Updates</h3><p>For the ones of you who want to live on the bleeding edge of T-Pot development we introduced an update feature which will allow you to update all T-Pot relevant files to be up to date with the T-Pot master branch. If you made any relevant changes to the T-Pot relevant config files make sure to create a backup first.  </p>
<ul>
<li>The Update script will</li>
<li>merciless overwrite local changes to be in sync with the T-Pot master branch</li>
<li>upgrade the system to the packages available in Debian (Sid)</li>
<li>update all resources to be in-sync with the T-Pot master branch</li>
<li>ensure all T-Pot relevant system files will be patched / copied into the original T-Pot state<br>You simply run the update script:  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/tpot/</span><br><span class="line">./update.sh -y</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>

    

    
    
    

    
    <div>
    
      <div>
    
        <div
        style="text-align:center;color: #ccc;font-size:14px;">---本文结束<i class="far fa-grin"></i>感谢您的阅读---
        </div>
    
</div>

    
    </div>
    
    
    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/wechatqcode.png" alt="北岸冷若冰霜 wechat" style="width: 560px; height: 160px; max-width: 100%;"/>
    <div>欢迎使用微信扫一扫上面的二维码，订阅我的公众号！</div>
</div>

      </div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创分享，点击下方打赏，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/rwdwechatpay.jpg" alt="北岸冷若冰霜 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/rwdalipay.jpg" alt="北岸冷若冰霜 支付宝"/>
        <p>支付宝</p>
      </div>
    

    
      <div id="bitcoin" style="display: inline-block">
        <img id="bitcoin_qr" src="/images/rwdbitcoin.jpg" alt="北岸冷若冰霜 比特币"/>
        <p>比特币</p>
      </div>
    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>北岸冷若冰霜</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://zerosun.top/2019/05/20/T-Pot-Multi-Honeypot-Platform-Revolution/" title="T-Pot:Multi-Honeypot-Platform-Revolution">https://zerosun.top/2019/05/20/T-Pot-Multi-Honeypot-Platform-Revolution/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Honeypot/" rel="tag"><i class="fa fa-tag"></i> Honeypot</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div class="social_share">
            
            
               <div id="needsharebutton-postbottom">
                 <span class="btn">
                    <i class="fa fa-share-alt" aria-hidden="true"></i>
                 </span>
               </div>
            
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/12/daily-efficient-instrument/" rel="next" title="提高日常学习工作生活效率的利器">
                <i class="fa fa-chevron-left"></i> 提高日常学习工作生活效率的利器
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="北岸冷若冰霜" />
            
              <p class="site-author-name" itemprop="name">北岸冷若冰霜</p>
              <p class="site-description motion-element" itemprop="description">和孤独签订体面的协议</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">22</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item" >
                  <a href="https://cybermap.kaspersky.com" target="_blank" title="Cybermap"><i class="fa fa-fw fa-globe"></i>Cybermap</a>
                  
                </span>
              
                <span class="links-of-author-item" >
                  <a href="https://www.zoomeye.org/statistics" target="_blank" title="Zoomeye"><i class="fa fa-fw fa-signal"></i>Zoomeye</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          <div id="music163player">
	<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" 
		width=330 height=86 
		src="//music.163.com/outchain/player?type=2&id=28828074&auto=0&height=66">
	</iframe>
</div>

<div id="days"></div>
<script>
function show_date_time()
{
	window.setTimeout("show_date_time()", 1000);
	BirthDay=new Date("06/22/2018 1:04:00");
	today=new Date();
	timeold=(today.getTime()-BirthDay.getTime());
	sectimeold=timeold/1000
	secondsold=Math.floor(sectimeold);
	msPerDay=24*60*60*1000
	e_daysold=timeold/msPerDay
	daysold=Math.floor(e_daysold);
	e_hrsold=(e_daysold-daysold)*24;
	hrsold=setzero(Math.floor(e_hrsold));
	e_minsold=(e_hrsold-hrsold)*60;
	minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
	seconds=setzero(Math.floor((e_minsold-minsold)*60));
	document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}

function setzero(i)
{
	if (i<10)
	{
		i="0" + i
	};
	return i;
}
show_date_time();
</script>
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#T-Pot-多蜜罐平台革命"><span class="nav-number">1.</span> <span class="nav-text">T-Pot:多蜜罐平台革命</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x00简述篇"><span class="nav-number">1.1.</span> <span class="nav-text">0x00简述篇</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#项目简介"><span class="nav-number">1.1.1.</span> <span class="nav-text">项目简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#系统架构"><span class="nav-number">1.1.2.</span> <span class="nav-text">系统架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#态势概览"><span class="nav-number">1.1.3.</span> <span class="nav-text">态势概览</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#技术概念"><span class="nav-number">1.1.4.</span> <span class="nav-text">技术概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Dockerized-Honeypots"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">Dockerized Honeypots</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Further-Tools"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">Further Tools</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01安装篇"><span class="nav-number">1.2.</span> <span class="nav-text">0x01安装篇</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02使用篇"><span class="nav-number">1.3.</span> <span class="nav-text">0x02使用篇</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#服务器管理：Web-Access"><span class="nav-number">1.3.1.</span> <span class="nav-text">服务器管理：Web Access</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#系统"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#容器"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#终端"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">终端</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tools"><span class="nav-number">1.3.2.</span> <span class="nav-text">Tools</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Cyberchef"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">Cyberchef</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ES-Head-Plugin"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">ES Head Plugin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Spiderfoot"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">Spiderfoot</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#蜜罐可视化：Kibana-Dashboard"><span class="nav-number">1.3.3.</span> <span class="nav-text">蜜罐可视化：Kibana Dashboard</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03优化篇"><span class="nav-number">1.4.</span> <span class="nav-text">0x03优化篇</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Updates"><span class="nav-number">1.4.1.</span> <span class="nav-text">Updates</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">北岸冷若冰霜</span>

  

  
</div>



<!--





  <div class="theme-info">主题 – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Mist</a> v6.4.0</div>


-->



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
    
    
	
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
























  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.4.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.4.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook,Evernote";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  

  
  
  
  <script src="/lib/bookmark/bookmark.min.js?v=1.0"></script>
  <script type="text/javascript">
  
    bookmark.scrollToMark('auto', "#更多");
  
  </script>


  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>



<!-- hexo百度站点自动推送 ---------------------------------------->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- ---------------------------------------------------------- -->

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>

</body>
</html>