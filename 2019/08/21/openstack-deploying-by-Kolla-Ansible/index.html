<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>Kolla-Ansible 部署OpenStack | 北岸冷若冰霜</title>
  
  
  <meta name="description" content="和孤独签订体面的协议">
  

  
  <link rel="alternate" href="/atom.xml" title="北岸冷若冰霜">
  

  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.10.1/css/all.min.css">
  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.9.2/css/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <h1 class='title'>Demo</h1>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-rss fa-fw'></i>&nbsp;博文
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/projects/"
            
            
            id="projects">
            <i class='fas fa-code-branch fa-fw'></i>&nbsp;项目
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/friends/"
            
              rel="nofollow"
            
            
            id="friends">
            <i class='fas fa-link fa-fw'></i>&nbsp;友链
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          北岸冷若冰霜
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-grin fa-fw'></i>&nbsp;示例
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="blogcategories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="blogtags">
									<i class='fas fa-hashtag fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blog/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="blogarchives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;近期文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blog/archives/"
                
                  rel="nofollow"
                
                
                id="blogarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/projects/"
                
                
                id="projects">
								<i class='fas fa-code-branch fa-fw'></i>&nbsp;开源项目
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="https://xaoxuu.com/wiki/material-x/"
                
                  rel="nofollow"
                
                
                id="https:xaoxuu.comwikimaterial-x">
								<i class='fas fa-book fa-fw'></i>&nbsp;主题文档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于小站
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  
    <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2019/08/21/openstack-deploying-by-Kolla-Ansible/">
        Kolla-Ansible 部署OpenStack
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    
      <a href="https://zerosun.top" rel="nofollow">
        
          <i class="fas fa-user" aria-hidden="true"></i>
        
        <p>北岸冷若冰霜</p>
      </a>
    
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-08-21</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/openstack/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>openstack</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          <p>持续更新。。。<br><a id="more"></a><br>参考链接<br><a href="https://docs.openstack.org/stein/" target="_blank" rel="noopener">https://docs.openstack.org/stein/</a></p>
<p>选择R版<br><a href="https://docs.openstack.org/rocky/index.html" target="_blank" rel="noopener">https://docs.openstack.org/rocky/index.html</a></p>
<p><a href="https://docs.openstack.org/rocky/deploy/" target="_blank" rel="noopener">https://docs.openstack.org/rocky/deploy/</a></p>
<p><a href="https://docs.openstack.org/project-deploy-guide/kolla-ansible/rocky/" target="_blank" rel="noopener">https://docs.openstack.org/project-deploy-guide/kolla-ansible/rocky/</a></p>
<h1 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h1><p>参考链接<br><a href="https://docs.openstack.org/project-deploy-guide/kolla-ansible/rocky/quickstart.html" target="_blank" rel="noopener">https://docs.openstack.org/project-deploy-guide/kolla-ansible/rocky/quickstart.html</a></p>
<h2 id="主机环境"><a href="#主机环境" class="headerlink" title="主机环境"></a>主机环境</h2><ul>
<li>系统：VMware Workstation ，Ubuntu server 16.04.2 LTS 64位</li>
<li>网口：2个，1个桥接，1个NAT</li>
<li>内存：2G</li>
<li>硬盘：64G</li>
</ul>
<p>另，所有操作过程是在root账户下直接进行的，目录亦是/root/</p>
<h2 id="安装依赖项"><a href="#安装依赖项" class="headerlink" title="安装依赖项"></a>安装依赖项</h2><ol>
<li><p>升级pip</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install python-pip</span><br><span class="line">pip install -U pip</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装依赖包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install python-dev libffi-dev gcc libssl-dev python-selinux python-setuptools git vim -y</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装Ansible</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install ansible</span><br></pre></td></tr></table></figure>
</li>
<li><p>(可选)使用pip安装或升级Ansible到最新版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U ansible</span><br></pre></td></tr></table></figure>
</li>
<li><p>（可选）将以下选项添加到ansible配置文件中 /etc/ansible/ansible.cfg：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[defaults]</span><br><span class="line">host_key_checking=False</span><br><span class="line">pipelining=True</span><br><span class="line">forks=100</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="安装Kolla-ansible"><a href="#安装Kolla-ansible" class="headerlink" title="安装Kolla-ansible"></a>安装Kolla-ansible</h2><h3 id="安装Kolla-ansible-for-deployment-or-evaluation"><a href="#安装Kolla-ansible-for-deployment-or-evaluation" class="headerlink" title="安装Kolla-ansible for deployment or evaluation"></a>安装Kolla-ansible for deployment or evaluation</h3><ol>
<li><p>使用安装kolla-ansible及其依赖项pip。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install kolla-ansible</span><br></pre></td></tr></table></figure>
<p>国内加速</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -i https://mirrors.aliyun.com/pypi/simple/ kolla-ansible</span><br></pre></td></tr></table></figure>
<p>排错记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U --ignore-installed PyYAML</span><br></pre></td></tr></table></figure>
</li>
<li><p>复制globals.yml和passwords.yml到/etc/kolla目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -r /usr/local/share/kolla-ansible/etc_examples/kolla /etc/</span><br></pre></td></tr></table></figure>
</li>
<li><p>将文件复制all-in-one和multinode库文件到当前目录。<br>本次记录当前路径为/root/</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/share/kolla-ansible/ansible/inventory/* .</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="安装-Kolla-for-development"><a href="#安装-Kolla-for-development" class="headerlink" title="安装 Kolla for development"></a>安装 Kolla for development</h3><ol>
<li><p>从GitHub克隆kolla 和 kolla-ansible 仓库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/openstack/kolla</span><br><span class="line">git clone https://github.com/openstack/kolla-ansible</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装kolla 和 kolla-ansible依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install -r kolla/requirements.txt</span><br><span class="line">pip install -r kolla-ansible/requirements.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>将配置文件复制到/etc/kolla目录下<br>kolla-ansible在etc/kolla目录下保存配置文件globals.yml 和 passwords.yml。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/kolla</span><br><span class="line">cp -r kolla-ansible/etc/kolla/* /etc/kolla</span><br></pre></td></tr></table></figure>
</li>
<li><p>复制库文件到当前目录<br>kolla-ansible在ansible/inventory目录下保存库文件all-in-one 和 multinode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp kolla-ansible/ansible/inventory/* .</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="准备初始配置"><a href="#准备初始配置" class="headerlink" title="准备初始配置"></a>准备初始配置</h2><h3 id="库文件"><a href="#库文件" class="headerlink" title="库文件"></a>库文件</h3><p>下一步是准备我们的inventory库存文件。Inventory是一个ansible文件，我们在其中指定节点角色和访问凭据。<br>Kolla-Ansible配备all-in-one和multinode例子 inventory库文件，它们之间的区别在于：</p>
<ul>
<li>前者all-in-one已准备好在localhost上部署单节点OpenStack。</li>
<li>multinode例子，如果您需要使用单独的主机或多个节点，请编辑multinode库文件，multinode例子如下：</li>
</ul>
<ol>
<li>编辑multinode文件的第一部分，包含multinode使用环境的连接信息。</li>
</ol>
<p>配置对应节点的服务的主机名称。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[control]</span><br><span class="line">10.0.0.[10:12] ansible_user=ubuntu ansible_password=foobar ansible_become=true</span><br><span class="line"><span class="meta">#</span><span class="bash"> Ansible supports syntax like [10:12] - that means 10, 11 and 12.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Become clause means <span class="string">"use sudo"</span>.</span></span><br><span class="line"></span><br><span class="line">[network:children]</span><br><span class="line">control</span><br><span class="line"><span class="meta">#</span><span class="bash"> when you specify group_name:children, it will use contents of group specified.</span></span><br><span class="line"></span><br><span class="line">[compute]</span><br><span class="line">10.0.0.[13:14] ansible_user=ubuntu ansible_password=foobar ansible_become=true</span><br><span class="line"></span><br><span class="line">[monitoring]</span><br><span class="line">10.0.0.10</span><br><span class="line"><span class="meta">#</span><span class="bash"> This group is <span class="keyword">for</span> monitoring node.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Fill it with one of the controllers<span class="string">' IP address or some others.</span></span></span><br><span class="line"></span><br><span class="line">[storage:children]</span><br><span class="line">compute</span><br><span class="line"></span><br><span class="line">[deployment]</span><br><span class="line">localhost       ansible_connection=local become=true</span><br><span class="line"><span class="meta">#</span><span class="bash"> use localhost and sudo</span></span><br></pre></td></tr></table></figure>
<p>另，To learn more about inventory files, 打开 <a href="http://docs.ansible.com/ansible/latest/intro_inventory.html" target="_blank" rel="noopener">Ansible documentation</a>.</p>
<ol start="2">
<li><p>检查库文件配置是否正确</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i multinode all -m ping</span><br></pre></td></tr></table></figure>
<p>注意：<br>Ubuntu可能没有预先安装python。这将导致ping模块出错。<br>要使用ansible快速安装python，您可以运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i multinode all -m raw -a &quot;apt-get -y install python-dev&quot;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Kolla-密码"><a href="#Kolla-密码" class="headerlink" title="Kolla 密码"></a>Kolla 密码</h3><p>部署过程中使用到的密码存储在/etc/kolla/passwords.yml文件中。<br>此文件中的所有密码都是空白的，必须手动填写或运行随机密码生成器：</p>
<ul>
<li><p>对于for deployment or evaluation，请运行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-genpwd</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于development，请运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd kolla-ansible/tools</span><br><span class="line">./generate_passwords.py</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Kolla-globals-yml"><a href="#Kolla-globals-yml" class="headerlink" title="Kolla globals.yml"></a>Kolla globals.yml</h3><p>globals.yml是Kolla-Ansible的主要配置文件。部署Kolla-Ansible需要一些选项，具体可打开globals.yml文件查看，下面会对：</p>
<ul>
<li>镜像：Image options</li>
<li>网络：Networking</li>
<li>启用其他服务：Enable additional services</li>
</ul>
<p>进行简介。</p>
<ol>
<li><p>Image options<br>必须指定用于部署使用的镜像，这里先使用DockerHub提供预先构建的镜像。<br>要了解有关的构建机制，参阅镜像构建文档<a href="https://docs.openstack.org/kolla/latest/admin/image-building.html" target="_blank" rel="noopener">Building Container Images</a>。<br>Kolla提供了几种容器中Linux发行版的选择：Centos、Ubuntu、Oraclelinux、Debian、RHEL。<br>对于新手的话，建议使用Centos或者Ubuntu 16.04.即：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla_base_distro: &quot;centos&quot;</span><br></pre></td></tr></table></figure>
<p>下一步关于安装类型“type”需要配置，可选项有<br><strong>binary</strong>：using repositories like apt or yum<br><strong>source</strong>：using raw source archives, git repositories or local source directory<br>注意：这仅影响OpenStack服务。像Ceph这样的基础设施服务总是“二进制”的。<br>注意：且经证明，源代码构建比二进制代码更可靠。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla_install_type: &quot;source&quot;</span><br></pre></td></tr></table></figure>
<p> 要使用DockerHub镜像，必须覆盖修改镜像标签。镜像都标有发行版本名称。例如使用稳定的Rocky镜像，就设置为下面的。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack_release: &quot;rocky&quot;</span><br></pre></td></tr></table></figure>
<p> 使用与kolla-ansible相同版本的镜像非常重要。这意味着如果pip用于安装kolla-ansible，这意味着它是最新的稳定版本，所以<strong>openstack_release</strong>应该设置为rocky。如果git与master分支一起使用，DockerHub也提供了master分支的每日构建（标记为<strong>master</strong>）：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack_release: &quot;master&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Networking<br>Kolla-Ansible需要设置一些网络选项。我们需要设置OpenStack使用的网络接口.</p>
<ul>
<li><p>(1)设置的第一个接口是<strong>network_interface</strong>。这是多个管理类型网络的默认接口.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">network_interface: &quot;eth0&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>(2)所需的第二个接口专用于Neutron外部（或公共）网络，可以是vlan或flat，取决于网络的创建方式。此接口应在没有IP地址的情况下处于活动,如果不是，实例将无法访问外部网络。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">neutron_external_interface: &quot;eth1&quot;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>另，要了解更多有关网络配置，请参阅网络概览<a href="https://docs.openstack.org/kolla-ansible/latest/admin/production-architecture-guide.html#network-configuration" target="_blank" rel="noopener">Network overview</a></p>
<ul>
<li>(3)接下来，我们需要为管理流量提供浮动IP。此IP将由keepalived管理以提供高可用性，并应设置为 未连接到我们的管理网络中的地址 network_interface。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla_internal_vip_address: &quot;10.1.0.250&quot;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Enable additional services<br>默认情况下，Kolla-Ansible提供了一个裸计算工具包，但它确实为大量附加服务提供支持。要启用它们，请设置 <strong>enable_*</strong>为“<strong>yes</strong>”。例如，要启用块存储服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enable_cinder: &quot;yes&quot;</span><br></pre></td></tr></table></figure>
<p>另，Kolla现在支持许多OpenStack服务，有 一个可用服务列表<a href="https://github.com/openstack/kolla-ansible/blob/master/README.rst#openstack-services" target="_blank" rel="noopener"> a list of available services</a>。有关服务配置的详细信息，请参阅服务参考指南<a href="https://docs.openstack.org/kolla-ansible/latest/reference/index.html" target="_blank" rel="noopener"> Services Reference Guide</a></p>
</li>
</ol>
<h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><p>配置完成后，我们可以进入部署阶段。<br>首先，我们需要设置基本的主机级依赖项，例如docker。<br>Kolla-Ansible提供了一个将以正确版本安装所有必需服务的剧本。</p>
<ul>
<li>对于部署或评估，请运行：</li>
</ul>
<ol>
<li>具有kolla部署依赖关系的引导服务器：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-ansible -i ./multinode bootstrap-servers</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>回车之后报错<br><img src="/img/20190822172739.png" alt="img"><br><a href="https://www.voidking.com/dev-ubuntu16-kolla-openstack-all-in-one/" target="_blank" rel="noopener">参考解决</a><br>（1）ansible –version，查看ansible版本为2.0.0.2，确实非常低。<br>（2）apt install ansible，提示已经是最新版本。<br>（3）更新apt库，然后重装ansible<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ansible --version</span><br><span class="line">apt-get install software-properties-common</span><br><span class="line">apt-add-repository ppa:ansible/ansible</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install ansible</span><br><span class="line">ansible --version</span><br><span class="line">apt install ansible</span><br></pre></td></tr></table></figure></p>
<p>安装过程需要进行确认等操作，仔细看提示，重新编辑/etc/ansible/ansible.cfg，<br>再次执行初始化命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-ansible -i ./multinode bootstrap-servers</span><br></pre></td></tr></table></figure></p>
<p>问题解决。时间需要很久很久，请耐心等待。</p>
<ol start="2">
<li><p>对主机进行预部署检查：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-ansible -i ./multinode prechecks</span><br></pre></td></tr></table></figure>
</li>
<li><p>最后进入实际的OpenStack部署：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-ansible -i ./multinode deploy</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>对于开发，运行：</li>
</ul>
<ol>
<li><p>具有kolla部署依赖关系的引导服务器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd kolla-ansible/tools</span><br><span class="line">./kolla-ansible -i ../ansible/inventory/multinode bootstrap-servers</span><br></pre></td></tr></table></figure>
</li>
<li><p>对主机进行预部署检查：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kolla-ansible -i ../ansible/inventory/multinode prechecks</span><br></pre></td></tr></table></figure>
</li>
<li><p>最后进入实际的OpenStack部署：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kolla-ansible -i ../ansible/inventory/multinode deploy</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>另，当这个剧本完成时，OpenStack应该启动，运行并且功能齐全！如果执行期间发生错误，请参阅故障排除指南<a href="https://docs.openstack.org/kolla-ansible/latest/user/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a></p>
<h2 id="使用-OpenStack"><a href="#使用-OpenStack" class="headerlink" title="使用 OpenStack"></a>使用 OpenStack</h2><ol>
<li><p>安装基本的OpenStack CLI客户端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install python-openstackclient python-glanceclient python-neutronclient</span><br></pre></td></tr></table></figure>
</li>
<li><p>OpenStack需要一个openrc文件，其中设置了admin用户的凭据。要生成此文件：</p>
</li>
</ol>
<ul>
<li><p>对于部署或评估，请运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kolla-ansible post-deploy</span><br><span class="line">. /etc/kolla/admin-openrc.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于开发，运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd kolla-ansible/tools</span><br><span class="line">./kolla-ansible post-deploy</span><br><span class="line">. /etc/kolla/admin-openrc.sh</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="3">
<li>根据您安装Kolla-Ansible的方式，有一个脚本可以创建示例网络，图像等。</li>
</ol>
<ul>
<li>对于部署或评估，</li>
</ul>
<p>请init-runonce在CentOS上运行脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. /usr/share/kolla-ansible/init-runonce</span><br></pre></td></tr></table></figure></p>
<p>init-runonce在Ubuntu上运行脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. /usr/local/share/kolla-ansible/init-runonce</span><br></pre></td></tr></table></figure></p>
<ul>
<li>对于开发，运行：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. kolla-ansible/tools/init-runonce</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Kolla的多节点部署"><a href="#Kolla的多节点部署" class="headerlink" title="Kolla的多节点部署"></a>Kolla的多节点部署</h1><p>参考链接<br><a href="https://docs.openstack.org/project-deploy-guide/kolla-ansible/rocky/multinode.html" target="_blank" rel="noopener">https://docs.openstack.org/project-deploy-guide/kolla-ansible/rocky/multinode.html</a></p>
<h2 id="部署注册表"><a href="#部署注册表" class="headerlink" title="部署注册表"></a>部署注册表</h2><p>Docker注册表是一个本地托管的注册表，它取代了从Docker Hub获取图像的需要。Kolla可以在有或没有本地注册表的情况下运行，但是对于多节点部署，某些类型的注册表是强制性的。尽管存在用于注册表服务的HA功能，但只能部署一个注册表。<br>版本2.3之前的Docker注册表具有极差的性能，因为所有容器数据都是针对每个图像推送的，而不是利用Docker分层来优化推送操作。有关更多信息，请参阅pokey registry <a href="https://github.com/docker/docker/issues/14018" target="_blank" rel="noopener">pokey注册表</a></p>
<ol>
<li><p>编辑/etc/kolla/globals.yml并添加以下内容，其中192.168.1.100是计算机的IP地址，5000是注册表当前运行的端口</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker_registry: 192.168.1.100:5000</span><br></pre></td></tr></table></figure>
</li>
<li><p>Kolla社区建议使用注册表2.3或更高版本。<br>另，如果要部署2.3或更高版本的注册表，请执行以下操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd kolla</span><br><span class="line">tools/start-registry</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>3.Docker注册表可以配置为拉出缓存，以代理Docker Hub中托管的官方Kolla映像。为了将本地注册表配置为拉入式缓存，在主机中将环境变量设置REGISTRY_PROXY_REMOTEURL为Docker Hub上存储库的URL。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export REGISTRY_PROXY_REMOTEURL=https://registry-1.docker.io</span><br></pre></td></tr></table></figure></p>
<h2 id="在所有节点配置Docker"><a href="#在所有节点配置Docker" class="headerlink" title="在所有节点配置Docker"></a>在所有节点配置Docker</h2><p>启动注册表后，有必要指示Docker将与不安全的注册表进行通信。例如，要启用不安全的注册表通信，请修改该/etc/docker/daemon.json文件以包含以下内容 192.168.1.100：当前运行注册表的计算机的IP地址：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "insecure-registries" : ["192.168.1.100:5000"]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>执行以下命令重启Docker：</p>
<ul>
<li><p>对于带有systemd的CentOS或Ubuntu：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于使用upstart或sysvinit的Ubuntu：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="编辑库文件Inventory-File"><a href="#编辑库文件Inventory-File" class="headerlink" title="编辑库文件Inventory File"></a>编辑库文件Inventory File</h2><p>ansible库文件包含确定哪些服务将在哪些主机上登陆所需的所有信息。编辑Kolla-Ansible目录中的库存文件ansible/inventory/multinode。<br>如果Kolla-Ansible安装了pip，可以在/usr/share/kolla-ansible。</p>
<p>将IP地址或主机名添加到组中，与该组关联的服务将登陆该主机。必须将IP地址或主机名添加到组控制，网络，计算，监视和存储中。<br>此外，定义附加的行为清单参数诸如ansible_ssh_user， ansible_become和ansible_private_key_file/ansible_ssh_pass控制与远程主机如何ansible相互作用。</p>
<p>另，Ansible使用SSH连接部署主机和目标主机，应注意配置免密登录。更多的配置参阅<a href="http://docs.ansible.com/ansible/intro_inventory.html" target="_blank" rel="noopener">Ansible文档</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> These initial groups are the only groups required to be modified. The</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> additional groups are <span class="keyword">for</span> more control of the environment.</span></span><br><span class="line">[control]</span><br><span class="line"><span class="meta">#</span><span class="bash"> These hostname must be resolvable from your deployment host</span></span><br><span class="line">control01      ansible_ssh_user=&lt;ssh-username&gt; ansible_become=True ansible_private_key_file=&lt;path/to/private-key-file&gt;</span><br><span class="line">192.168.122.24 ansible_ssh_user=&lt;ssh-username&gt; ansible_become=True ansible_private_key_file=&lt;path/to/private-key-file&gt;</span><br></pre></td></tr></table></figure>
<p>另外，根据具体的环境配置可能还会需要修改其他的库参数，参阅<a href="http://docs.ansible.com/ansible/intro_inventory.html" target="_blank" rel="noopener">Ansible文档</a></p>
<p>对于更高级的角色，操作员可以编辑与每个组关联的服务。请记住，某些服务必须组合在一起，更改这些服务可能会破坏您的部署：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[kibana:children]</span><br><span class="line">control</span><br><span class="line"></span><br><span class="line">[elasticsearch:children]</span><br><span class="line">control</span><br><span class="line"></span><br><span class="line">[haproxy:children]</span><br><span class="line">network</span><br></pre></td></tr></table></figure>
<h3 id="部署-Kolla"><a href="#部署-Kolla" class="headerlink" title="部署 Kolla"></a>部署 Kolla</h3><ul>
<li>注意<br>如果在同一第2层网络中运行多个keepalived集群，请编辑该文件/etc/kolla/globals.yml并指定 keepalived_virtual_router_id。本keepalived_virtual_router_id应该是唯一的，属于范围0〜255。</li>
<li>注意<br>如果将glance配置为file用作后端，则只会glance_api 启动一个容器。file默认情况下在未指定其他后端时启用/etc/kolla/globals.yml。</li>
</ul>
<ol>
<li>首先，检查部署目标是否处于Kolla可能部署到的状态：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-ansible prechecks -i &lt;path/to/multinode/inventory/file&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>注意<br>RabbitMQ不能与IP地址一起使用，因此api_interface主机名应该可以解析IP地址， 以确保所有RabbitMQ Cluster主机可以事先解析彼此的主机名。</li>
</ul>
<ol start="2">
<li>运行部署：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-ansible deploy -i &lt;path/to/multinode/inventory/file&gt;</span><br></pre></td></tr></table></figure></li>
</ol>

        </div>
        
          


  <section class='meta' id="footer-meta">
    <hr>
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-08-23T08:35:58+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>更新于 2019年8月23日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/OpenStack/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>OpenStack</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Ansible/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>Ansible</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Kolla/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>Kolla</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/tools/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>tools</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://zerosun.top/2019/08/21/openstack-deploying-by-Kolla-Ansible/&title=Kolla-Ansible 部署OpenStack | 北岸冷若冰霜&summary=持续更新。。。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://zerosun.top/2019/08/21/openstack-deploying-by-Kolla-Ansible/&title=Kolla-Ansible 部署OpenStack | 北岸冷若冰霜&summary=持续更新。。。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://zerosun.top/2019/08/21/openstack-deploying-by-Kolla-Ansible/&title=Kolla-Ansible 部署OpenStack | 北岸冷若冰霜&summary=持续更新。。。"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
            <div class="prev-next">
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/2019/08/12/openstack-deploying-by-OSA/" rel="prev" title="OpenStack Ansible部署OpenStack">
                                    
                                        OpenStack Ansible部署OpenStack
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/Tools/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>Tools</a> <a class="tag" href="/tags/OpenStack/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>OpenStack</a> <a class="tag" href="/tags/Ansible/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>Ansible</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'Kolla-Ansible 部署OpenStack',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
    
    
      
        
          
          
            <section class='widget author'>
  <div class='content pure'>
    
      <div class='avatar'>
        <img class='avatar' src='https://cdn.jsdelivr.net/gh/xaoxuu/assets@master/avatar/avatar.png'/>
      </div>
    
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:me@xaoxuu.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/xaoxuu"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=63035382"
              class="social fas fa-headphones-alt flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

          
        
      
        
          
          
            
  <section class='widget toc-wrapper'>
    
<header class='pure'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
  
</header>

    <div class='content pure'>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#快速开始"><span class="toc-text">快速开始</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#主机环境"><span class="toc-text">主机环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装依赖项"><span class="toc-text">安装依赖项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装Kolla-ansible"><span class="toc-text">安装Kolla-ansible</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装Kolla-ansible-for-deployment-or-evaluation"><span class="toc-text">安装Kolla-ansible for deployment or evaluation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装-Kolla-for-development"><span class="toc-text">安装 Kolla for development</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#准备初始配置"><span class="toc-text">准备初始配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#库文件"><span class="toc-text">库文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kolla-密码"><span class="toc-text">Kolla 密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kolla-globals-yml"><span class="toc-text">Kolla globals.yml</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#部署"><span class="toc-text">部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用-OpenStack"><span class="toc-text">使用 OpenStack</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Kolla的多节点部署"><span class="toc-text">Kolla的多节点部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#部署注册表"><span class="toc-text">部署注册表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在所有节点配置Docker"><span class="toc-text">在所有节点配置Docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编辑库文件Inventory-File"><span class="toc-text">编辑库文件Inventory File</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#部署-Kolla"><span class="toc-text">部署 Kolla</span></a></li></ol></li></ol></li></ol>
    </div>
  </section>


          
        
      
        
          
          
            <section class='widget grid'>
  
<header class='pure'>
  <div><i class="fas fa-map-signs fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;站内导航</div>
  
</header>

  <div class='content pure'>
    <ul class="grid navgation">
      
        <li><a class="flat-box" title="/" href="/"
          
          
          id="home">
          
            <i class="fas fa-clock fa-fw" aria-hidden="true"></i>
          
          近期文章
        </a></li>
      
        <li><a class="flat-box" title="/blog/archives/" href="/blog/archives/"
          
            rel="nofollow"
          
          
          id="blogarchives">
          
            <i class="fas fa-archive fa-fw" aria-hidden="true"></i>
          
          文章归档
        </a></li>
      
        <li><a class="flat-box" title="/projects/" href="/projects/"
          
          
          id="projects">
          
            <i class="fas fa-code-branch fa-fw" aria-hidden="true"></i>
          
          开源项目
        </a></li>
      
        <li><a class="flat-box" title="/friends/" href="/friends/"
          
            rel="nofollow"
          
          
          id="friends">
          
            <i class="fas fa-link fa-fw" aria-hidden="true"></i>
          
          我的友链
        </a></li>
      
        <li><a class="flat-box" title="https://xaoxuu.com/wiki/material-x/" href="https://xaoxuu.com/wiki/material-x/"
          
            rel="nofollow"
          
          
          id="https:xaoxuu.comwikimaterial-x">
          
            <i class="fas fa-book fa-fw" aria-hidden="true"></i>
          
          主题文档
        </a></li>
      
        <li><a class="flat-box" title="/about/" href="/about/"
          
            rel="nofollow"
          
          
          id="about">
          
            <i class="fas fa-info-circle fa-fw" aria-hidden="true"></i>
          
          关于小站
        </a></li>
      
    </ul>
  </div>
</section>

          
        
      
        
          
          
            
  <section class='widget category'>
    
<header class='pure'>
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;文章分类</div>
  
    <a class="rightBtn"
    
      rel="nofollow"
    
    
    href="/blog/categories/"
    title="blog/categories/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/Blockchain/" href="/categories/Blockchain/"><div class='name'>Blockchain</div><div class='badge'>(0)</div></a></li>
        
          <li><a class="flat-box" title="/categories/blockchain/" href="/categories/blockchain/"><div class='name'>blockchain</div><div class='badge'>(7)</div></a></li>
        
          <li><a class="flat-box" title="/categories/ctf/" href="/categories/ctf/"><div class='name'>ctf</div><div class='badge'>(0)</div></a></li>
        
          <li><a class="flat-box" title="/categories/favorites/" href="/categories/favorites/"><div class='name'>favorites</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box" title="/categories/openstack/" href="/categories/openstack/"><div class='name'>openstack</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box" title="/categories/raspberrypi/" href="/categories/raspberrypi/"><div class='name'>raspberrypi</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box" title="/categories/reading/" href="/categories/reading/"><div class='name'>reading</div><div class='badge'>(6)</div></a></li>
        
          <li><a class="flat-box" title="/categories/tools/" href="/categories/tools/"><div class='name'>tools</div><div class='badge'>(5)</div></a></li>
        
      </ul>
    </div>
  </section>


          
        
      
        
          
          
            
  <section class='widget tagcloud'>
    
<header class='pure'>
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
    <a class="rightBtn"
    
      rel="nofollow"
    
    
    href="/blog/tags/"
    title="blog/tags/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      <a href="/tags/Ansible/" style="font-size: 17.33px; color: #828282">Ansible</a> <a href="/tags/BlockChain/" style="font-size: 22.33px; color: #606060">BlockChain</a> <a href="/tags/BookList/" style="font-size: 15.67px; color: #8e8e8e">BookList</a> <a href="/tags/Ethereum/" style="font-size: 15.67px; color: #8e8e8e">Ethereum</a> <a href="/tags/Github/" style="font-size: 14px; color: #999">Github</a> <a href="/tags/HOWTO/" style="font-size: 14px; color: #999">HOWTO</a> <a href="/tags/Hash/" style="font-size: 15.67px; color: #8e8e8e">Hash</a> <a href="/tags/Honeypot/" style="font-size: 14px; color: #999">Honeypot</a> <a href="/tags/Kolla/" style="font-size: 14px; color: #999">Kolla</a> <a href="/tags/Linux/" style="font-size: 15.67px; color: #8e8e8e">Linux</a> <a href="/tags/MIST/" style="font-size: 14px; color: #999">MIST</a> <a href="/tags/MV/" style="font-size: 14px; color: #999">MV</a> <a href="/tags/Markdown/" style="font-size: 14px; color: #999">Markdown</a> <a href="/tags/OpenStack/" style="font-size: 19px; color: #777">OpenStack</a> <a href="/tags/RSS/" style="font-size: 14px; color: #999">RSS</a> <a href="/tags/Raspberrypi/" style="font-size: 14px; color: #999">Raspberrypi</a> <a href="/tags/Reading/" style="font-size: 20.67px; color: #6c6c6c">Reading</a> <a href="/tags/SmartContract/" style="font-size: 14px; color: #999">SmartContract</a> <a href="/tags/Tools/" style="font-size: 24px; color: #555">Tools</a> <a href="/tags/hexo/" style="font-size: 14px; color: #999">hexo</a> <a href="/tags/tools/" style="font-size: 15.67px; color: #8e8e8e">tools</a>
    </div>
  </section>


          
        
      
        
          
          
            


  <section class='widget music'>
    
<header class='pure'>
  <div><i class="fas fa-compact-disc fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;最近在听</div>
  
    <a class="rightBtn"
    
      rel="external nofollow noopener noreferrer"
    
    
      target="_blank"
    
    href="https://music.163.com/#/user/home?id=63035382"
    title="https://music.163.com/#/user/home?id=63035382">
    <i class="far fa-heart fa-fw"></i></a>
  
</header>

    <div class='content pure'>
      
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.7.0/dist/APlayer.min.css">
  <div class="aplayer"
    data-theme="#1BCDFC"
    
    
    data-mode="circulation"
    data-server="netease"
    data-type="playlist"
    data-id="2615636388"
    data-volume="0.7">
  </div>
  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.7.0/dist/APlayer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/meting@1.1.0/dist/Meting.min.js"></script>


    </div>
  </section>


          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="/atom.xml"
            class="social fas fa-rss flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="mailto:me@xaoxuu.com"
            class="social fas fa-envelope flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://github.com/xaoxuu"
            class="social fab fa-github flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://music.163.com/#/user/home?id=63035382"
            class="social fas fa-headphones-alt flat-btn"
            target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
  <div>
    本站使用
    <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a>
    作为主题
    
      ，
      总访问量为
      <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
      次
    
    。
  </div>
</footer>
<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://img.vim-cn.com/29/91197b04c13f512f734a76d4ac422d89dbe229.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        } else {
          $.backstretch(
          ["https://img.vim-cn.com/29/91197b04c13f512f734a76d4ac422d89dbe229.jpg"],
          {
            duration: "6000",
            fade: "2500"
          });
        }
      });
    </script>
  











  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.9/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-material-x@19.9/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
</body>
</html>
